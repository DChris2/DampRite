<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>DampRite</title>
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#e6f0ff">
  <link rel="icon" href="/assets/icon-192.png">
  <link rel="apple-touch-icon" href="/assets/icon-192.png">
  <link rel="stylesheet" href="/style.css">
  <script defer src="/script.js"></script>
</head>
<body>
  <header class="header">
    <img src="/assets/DampRite_251108_201012.jpg" alt="DampRite">
  </header>
  <nav class="toplinks">
    <a href="/index.html">Home</a>
    <a href="/learn.html">Learn About Damp</a>
    <a id="contactLink" href="#">Contact us</a>
  </nav>

  <div class="container">
    <div class="card">
      <span class="badge">Your path to a drier home</span>
      <h1>Get started</h1>
      <p>Follow these steps and we'll guide you to a solution:</p>
      <ol>
        <li><strong>Upload or take a photo</strong> of the affected area.</li>
        <li>Open the <strong>Analyse Tool</strong> — we’ll give you an <em>indicative</em> damp category.</li>
        <li>Read the <strong>explanation and product resolution</strong> suggestions.</li>
        <li>Optionally download our <strong>DIY guide (£0.99)</strong>.</li>
        <li>For complex cases, we can refer you to a <strong>qualified surveyor</strong>.</li>
      </ol>
      <div class="note small">This is guidance only. Always follow product instructions and consult professionals when unsure.</div>
    </div>

    <div class="card grid cols-2">
      <div>
        <h2>Upload / Take Photo</h2>
        <p class="muted">Use your camera or choose from your gallery.</p>
        <input id="fileInput" class="input" type="file" accept="image/*" capture="environment">
        <div id="preview" class="placeholder small" style="margin-top:10px;">Image preview will appear here.</div>
        <div style="margin-top:12px; display:flex; gap:8px;">
          <button class="button" onclick="openAnalyse()">Analyse Tool</button>
          <button class="button secondary" onclick="openAgent()">Ask Agent</button>
        </div>
      </div>
      <div>
        <h2>Downloadable Guides (£0.99 each)</h2>
        <p class="muted">Clear steps, tools, products and timescales with photos & illustrations.</p>
        <button class="button" onclick="openGuides()">View Guides</button>
        <div class="small muted" style="margin-top:8px">Delivery options: Email, Post, or Both.</div>
      </div>
    </div>

    <!-- Google AdSense Placeholder -->
    <div class="card placeholder">
      <strong>AdSense Placeholder</strong><br>
      Add your AdSense script here later.
    </div>

    <!-- Product Showlist Placeholder -->
    <div class="card placeholder">
      <strong>Affiliate Product Showlist Placeholder</strong><br>
      Add products relevant to each DIY project here.
    </div>

    <div class="footer">
      We respect your privacy and follow GDPR guidelines. Uploaded images are analysed only to assist in damp diagnosis and are not shared externally.
      <br><span id="contactEmail" class="hidden">Contact: <a href="mailto:dampriterelay@gmail.com">dampriterelay@gmail.com</a></span>
    </div>
  </div>

  <!-- Analyse Modal -->
  <div id="analyseModal" class="modal" role="dialog" aria-modal="true">
    <div class="modal-card">
      <div class="modal-head">
        <strong>Analyse Tool</strong>
        <button class="button secondary small" onclick="closeAnalyse()">Close</button>
      </div>
      <div class="modal-body">
        <p>This tool gives an indicative category based on your photo and answers:</p>
        <ul>
          <li>Likely damp type (Rising / Penetrating / Condensation).</li>
          <li>Short explanation and suggested next steps.</li>
          <li>Links to guides and relevant products.</li>
        </ul>
        <div class="note small">Future AI integration will refine detection and suggestions.</div>
        <div style="margin-top:10px; display:flex; gap:8px;">
          <button class="button" onclick="openAgent()">Ask Agent</button>
          <button class="button secondary" onclick="openGuides()">Open Guides</button>
        </div>
      </div>
      <div class="modal-foot">
        <span class="muted small">Preview only – not professional advice.</span>
      </div>
    </div>
  </div>

  <!-- Guides Modal -->
  <div id="guidesModal" class="modal" role="dialog" aria-modal="true">
    <div class="modal-card">
      <div class="modal-head">
        <strong>Downloadable Guides (£0.99 each)</strong>
        <button class="button secondary small" onclick="closeGuides()">Close</button>
      </div>
      <div class="modal-body">
        <div class="preview-mask">
          <iframe src="/guides/Rising Damp.pdf" title="Rising Damp Guide Preview"></iframe>
        </div>
        <p class="small muted">
          Emailed and/or Posted <strong>£0.99</strong>. Includes tools needed, products, steps to be taken and timescales with photos and illustrations for guidance.
        </p>
        <div class="grid">
          <button class="button">Email Delivery (£0.99)</button>
          <button class="button">Post A4 Copy (£0.99)</button>
          <button class="button">Both Email + Post (£0.99)</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Ask Agent Modal (AI Placeholder) -->
  <div id="agentModal" class="modal" role="dialog" aria-modal="true">
    <div class="modal-card">
      <div class="modal-head">
        <strong>Ask DampRite Agent</strong>
        <button class="button secondary small" onclick="closeAgent()">Close</button>
      </div>
      <div class="modal-body">
        <div class="note small">Type your question about damp. The agent will guide you toward a resolution and suitable products.</div>
        <textarea id="agentInput" class="input" rows="5" placeholder="e.g., There is mould on my bedroom wall near the skirting."></textarea>
        <div class="small muted" style="margin-top:6px">Future AI Integration: connect backend / ChatGPT API here.</div>
        <div style="margin-top:10px; display:flex; gap:8px;">
          <button class="button" onclick="sendAgent()">Send</button>
          <a class="button secondary" href="mailto:dampriterelay@gmail.com">Email instead</a>
        </div>
        <pre id="agentLog" class="small muted" style="white-space:pre-wrap;margin-top:8px;"></pre>
      </div>
    </div>
  </div>

  <script>
    // Contact reveal
    document.getElementById('contactLink').addEventListener('click', function(e){ e.preventDefault(); document.getElementById('contactEmail').classList.remove('hidden'); window.scrollTo({top:document.body.scrollHeight, behavior:'smooth'}); });

    // File preview
    const fileInput = document.getElementById('fileInput');
    const preview = document.getElementById('preview');
    fileInput.addEventListener('change', (e)=>{ 
      const f = e.target.files[0]; if(!f) return;
      const img = document.createElement('img');
      img.style.maxWidth = '100%'; img.style.borderRadius='12px';
      img.onload = ()=>{ preview.innerHTML=''; preview.appendChild(img); }
      img.src = URL.createObjectURL(f);
    });

    // Modals
    function openAnalyse(){ document.getElementById('analyseModal').classList.add('open'); }
    function closeAnalyse(){ document.getElementById('analyseModal').classList.remove('open'); }
    function openGuides(){ document.getElementById('guidesModal').classList.add('open'); }
    function closeGuides(){ document.getElementById('guidesModal').classList.remove('open'); }
    function openAgent(){ document.getElementById('agentModal').classList.add('open'); }
    function closeAgent(){ document.getElementById('agentModal').classList.remove('open'); }

    // Agent placeholder
    function sendAgent(){
      const q = document.getElementById('agentInput').value.trim();
      const log = document.getElementById('agentLog');
      if(!q) { log.textContent = 'Please type a question first.'; return; }
      console.log('Agent placeholder activated:', q);
      log.textContent = 'Thanks! This is a placeholder. In production, an AI agent will respond here and route to guides/products.';
    }

    // PWA
    if('serviceWorker' in navigator){ window.addEventListener('load', ()=>{ navigator.serviceWorker.register('/service-worker.js'); }); }
  </script>
</body>
</html>
